<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.61">
<link rel="search" type="application/opensearchdescription+xml" title="Konstellation" href="/opensearch.xml"><title data-react-helmet="true">Config &amp; Environment | Konstellation</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Config &amp; Environment | Konstellation"><meta data-react-helmet="true" name="description" content="App configs are used to define variables that an application requires. In Konstellation, they are kept separate from the main app manifest. Configs are stored as a custom resource in Konstellation and passed to apps as environment variables."><meta data-react-helmet="true" property="og:description" content="App configs are used to define variables that an application requires. In Konstellation, they are kept separate from the main app manifest. Configs are stored as a custom resource in Konstellation and passed to apps as environment variables."><meta data-react-helmet="true" property="og:url" content="https://konstellation.dev/docs/apps/configuration"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="true"><link data-react-helmet="true" rel="canonical" href="https://konstellation.dev/docs/apps/configuration"><link rel="stylesheet" href="/styles.d4a37da5.css">
<link rel="preload" href="/styles.3cdb5148.js" as="script">
<link rel="preload" href="/runtime~main.8ab41bae.js" as="script">
<link rel="preload" href="/main.1807bde1.js" as="script">
<link rel="preload" href="/1.3c02cc62.js" as="script">
<link rel="preload" href="/2.694aefcc.js" as="script">
<link rel="preload" href="/29.7c6873eb.js" as="script">
<link rel="preload" href="/33.7caa915a.js" as="script">
<link rel="preload" href="/20ac7829.eb314f58.js" as="script">
<link rel="preload" href="/17896441.3f5aa49e.js" as="script">
<link rel="preload" href="/a7747f32.08221b31.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/logo_light.png" alt="Konstellation Logo"><strong class="navbar__title">Konstellation</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/konstellation/introduction">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/k11n/konstellation" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span><span class="DocSearch-Button-Key">⌘</span><span class="DocSearch-Button-Key">K</span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/logo_light.png" alt="Konstellation Logo"><strong class="navbar__title">Konstellation</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/konstellation/introduction">Docs</a></li><li class="menu__list-item"><a href="https://github.com/k11n/konstellation" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_2gpo"><div class="docSidebarContainer_3_JD" role="complementary"><div class="sidebar_2urC"><div class="menu menu--responsive menu_5FrY"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_Dm3K" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist" href="#!">Konstellation</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/konstellation/introduction">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/konstellation/why">Why Konstellation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/konstellation/principles">Principles</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist" href="#!">Getting Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/">Installation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/getting-started/deploy">Deploying Your First App</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Working With Apps</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/apps/basics">The Basics</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/apps/configuration">Config &amp; Environment</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/apps/develop">Development &amp; Debugging</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/apps/services">Microservices</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/apps/monitoring">Monitoring</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist" href="#!">Cluster Operation</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/clusters/creation">Cluster Creation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/clusters/users">Managing Users</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/clusters/networking">Networking</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/clusters/upgrading">Upgrading</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/clusters/migration">Cluster Migration</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Reference</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/manifest">App Manifest</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/reference/linkedserviceaccount">Linked Service Account</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3EyW"><div class="container padding-vert--lg docItemWrapper_1EkI"><div class="row"><div class="col docItemCol_2ASc"><div class="docItemContainer_3QWW"><article><header><h1 class="docTitle_1Lrw">Config &amp; Environment</h1></header><div class="markdown"><p>App configs are used to define variables that an application requires. In Konstellation, they are kept separate from the main app manifest. Configs are stored as a custom resource in Konstellation and <a href="https://12factor.net/config" target="_blank" rel="noopener noreferrer">passed to apps as environment variables</a>.</p><p>The interface for configurations is an YAML file. You can create or edit them in an editor to be saved to Kubernetes with <code>kon config edit</code>. Any changes to a config that an app relies on will automatically create a new release. This means that releases are versioned by configs in addition to build changes. This is important since a bad config update could botch a deployment.</p><p>There are two kinds of configs: config for a single app, or shared configs. They serve different purposes and can be used together.</p><p>To see the configs that are available on the current cluster, use <code>kon config list</code>.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="app-config"></a>App config<a aria-hidden="true" tabindex="-1" class="hash-link" href="#app-config" title="Direct link to heading">#</a></h3><p>App config is a config that&#x27;s usable by a single app. When you create an app config, it&#x27;s made available automatically to the app as environment variables. For more complex config structures, a copy of the config yaml is also set as env var <code>APP_CONFIG</code>.</p><p>For example, create a config for &quot;myapp&quot; with: <code>kon config edit --app myapp</code>.</p><div class="mdxCodeBlock_1XEh"><div style="color:#bfc7d5;background-color:#292d3e" class="codeBlockTitle_3nn1">myapp.yaml</div><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd undefined">Copy</button><div tabindex="0" class="prism-code language-yaml codeBlock_3iAC codeBlockWithTitle_3QsD"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">title</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> My website title</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">published_at</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1590564232</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">navigation</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">sidebar</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> hello</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> world</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">topnav</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> link1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> link2</span></div></div></div></div></div><p>When <code>myapp</code> is ran, it&#x27;ll will automatically receive these environment variables:</p><table><thead><tr><th align="left">env</th><th align="left">value</th></tr></thead><tbody><tr><td align="left">TITLE</td><td align="left">&quot;My website title&quot;</td></tr><tr><td align="left">PUBLISHED_AT</td><td align="left">&quot;1590564232&quot;</td></tr><tr><td align="left">APP_CONFIG</td><td align="left">a copy of the config in YAML</td></tr></tbody></table><p>Note that keys have been converted to upper case, and any dashes <code>-</code> that you might have in the key names are converted to underscores <code>_</code>.</p><p>Because the <code>navigation</code> field is not a simple scalar value, Konstellation does not attempt to convert it to an env var. Instead, the entire config file is available in the <code>APP_CONFIG</code> variable.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="shared-config"></a>Shared config<a aria-hidden="true" tabindex="-1" class="hash-link" href="#shared-config" title="Direct link to heading">#</a></h3><p>While app configs are great way to set app specific configurations, it could lead to duplication when the same configuration is required by multiple apps. For example, you may want to store connection to databases that multiple apps require. Editing each app config would be a massive duplication of effort.</p><p>Shared configs is the way to accomplish this. Shared configs are given names, and can be referenced by multiple apps. Below is an example of creating a shared config and using it in my app. Create a shared config with <code>kon config edit --name db-connection</code></p><div class="mdxCodeBlock_1XEh"><div style="color:#bfc7d5;background-color:#292d3e" class="codeBlockTitle_3nn1">db-connection.yaml</div><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd undefined">Copy</button><div tabindex="0" class="prism-code language-yaml codeBlock_3iAC codeBlockWithTitle_3QsD"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">engine</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> mysql</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">host</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> mysql.host.com</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">user</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> username</span></div></div></div></div></div><p>Once the config file is created, you can then reference it in the <code>configs</code> field in the manifest. <code>kon app edit &lt;myapp&gt;</code></p><div class="mdxCodeBlock_1XEh"><div style="color:#bfc7d5;background-color:#292d3e" class="codeBlockTitle_3nn1">App.yaml</div><div class="codeBlockContent_1u-d"><button type="button" aria-label="Copy code to clipboard" class="copyButton_10dd undefined">Copy</button><div tabindex="0" class="prism-code language-yaml codeBlock_3iAC codeBlockWithTitle_3QsD"><div class="codeBlockLines_b7E3" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> k11n.dev/v1alpha1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> App</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> myapp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> repo/myapp</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">configs</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> db</span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain">connection</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">targets</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(199, 146, 234)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> production</span></div></div></div></div></div><p>Save the app.yaml file and a new release will be created that passes it a new environment variable <code>DB_CONNECTION</code>, with the value being set to the contents of the db config in YAML.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2cZh" id="target-specific-overrides"></a>Target specific overrides<a aria-hidden="true" tabindex="-1" class="hash-link" href="#target-specific-overrides" title="Direct link to heading">#</a></h3><p>In certain cases, it&#x27;s desirable to have certain config attributes to differ between the different environments. For example, you may have a staging database and a production one. Konstellation offers a away to define target specific overrides.</p><p>When you edit a config by passing in a <code>--target</code> flag, it will create an override file where those values only apply to that specific target. At run time, all of the values you&#x27;ve defined for the target would be merged into the base config.</p><p>To see the final config values that a specific release of an app will receive, use the <code>kon config show</code> command.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/k11n/konstellation/edit/master/website/docs/apps/configuration.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/apps/basics"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« The Basics</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/apps/develop"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Development &amp; Debugging »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_3klQ"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#app-config" class="table-of-contents__link">App config</a></li><li><a href="#shared-config" class="table-of-contents__link">Shared config</a></li><li><a href="#target-specific-overrides" class="table-of-contents__link">Target specific overrides</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Introduction</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/konstellation/introduction">Intro</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/konstellation/why">Why Konstellation</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/konstellation/principles">Design Principles</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/apps/basics">Working with Apps</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/clusters/creation">Cluster Operation</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/reference/manifest">Reference</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a href="https://github.com/k11n/konstellation" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="text--center"><div>Apache 2.0 Licensed.</div></div></div></footer></div>
<script src="/styles.3cdb5148.js"></script>
<script src="/runtime~main.8ab41bae.js"></script>
<script src="/main.1807bde1.js"></script>
<script src="/1.3c02cc62.js"></script>
<script src="/2.694aefcc.js"></script>
<script src="/29.7c6873eb.js"></script>
<script src="/33.7caa915a.js"></script>
<script src="/20ac7829.eb314f58.js"></script>
<script src="/17896441.3f5aa49e.js"></script>
<script src="/a7747f32.08221b31.js"></script>
</body>
</html>